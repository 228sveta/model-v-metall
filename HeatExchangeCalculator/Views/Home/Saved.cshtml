@model List<HeatExchangeCalculator.Services.SavedCalculation>
@{
    ViewData["Title"] = "–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã";
}

<div class="text-center">
    <h1 class="display-4 mb-4">üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã</h1>
    <a href="/" class="btn btn-outline-primary mb-4">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–∞—Å—á–µ—Ç—É</a>
</div>

@if (TempData["Message"] != null)
{
    <div class="alert alert-success">
        @TempData["Message"]
    </div>
}

@if (!Model.Any())
{
    <div class="alert alert-info">
        <h5>üì≠ –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤</h5>
        <p>–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä–∞—Å—á–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ, —á—Ç–æ–±—ã –æ–Ω –ø–æ—è–≤–∏–ª—Å—è –∑–¥–µ—Å—å.</p>
    </div>
}
else
{
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5>üìö –°–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ (@Model.Count)</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–î–∞—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</th>
                                    <th>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var calc in Model.OrderByDescending(c => c.SaveDate))
                                {
                                    <tr>
                                        <td>@calc.Id</td>
                                        <td>
                                            <strong>@calc.Name</strong>
                                            @if (!string.IsNullOrEmpty(calc.Name) && calc.Name.StartsWith("–†–∞—Å—á–µ—Ç –æ—Ç"))
                                            {
                                                <br><small class="text-muted">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ</small>
                                            }
                                        </td>
                                        <td>@calc.SaveDate.ToString("dd.MM.yyyy HH:mm")</td>
                                        <td>
                                            <small>
                                                H=@calc.Parameters.LayerHeight –º, 
                                                w=@calc.Parameters.GasVelocity –º/—Å,
                                                G=@calc.Parameters.MaterialFlowRate –∫–≥/—Å
                                            </small>
                                        </td>
                                        <td>
                                            <a href="@Url.Action("LoadCalculation", new { id = calc.Id })" 
                                               class="btn btn-sm btn-primary">üìñ –û—Ç–∫—Ä—ã—Ç—å</a>
                                            <a href="@Url.Action("Result", new { 
                                                layerHeight = calc.Parameters.LayerHeight,
                                                volumetricHeatTransferCoefficient = calc.Parameters.VolumetricHeatTransferCoefficient,
                                                gasVelocity = calc.Parameters.GasVelocity,
                                                gasHeatCapacity = calc.Parameters.GasHeatCapacity,
                                                materialFlowRate = calc.Parameters.MaterialFlowRate,
                                                materialHeatCapacity = calc.Parameters.MaterialHeatCapacity,
                                                initialMaterialTemperature = calc.Parameters.InitialMaterialTemperature,
                                                initialGasTemperature = calc.Parameters.InitialGasTemperature,
                                                apparatusDiameter = calc.Parameters.ApparatusDiameter
                                            })" class="btn btn-sm btn-success">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</a>
                                            <form method="post" asp-action="DeleteCalculation" 
                                                  style="display:inline" 
                                                  onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–∞—Å—á–µ—Ç?');">
                                                <input type="hidden" name="id" value="@calc.Id" />
                                                <button type="submit" class="btn btn-sm btn-danger">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                                            </form>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
}